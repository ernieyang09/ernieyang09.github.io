{"version":3,"sources":["webpack:///path---1-db688be850577790c0d9.js","webpack:///./.cache/json/1.json"],"names":["webpackJsonp","./node_modules/json-loader/index.js!./.cache/json/1.json","module","exports","data","allMarkdownRemark","edges","node","fields","slug","frontmatter","title","date","tags","release","html","pathContext","offset","paginations","total"],"mappings":"AAAAA,cAAc,iBAERC,2DACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,mBAAqBC,QAAUC,MAAQC,QAAUC,KAAA,wBAA8BC,aAAgBC,MAAA,gBAAAC,KAAA,mBAAAC,MAAA,SAAAC,SAAA,GAAkFC,KAAA,0oIAA4wIR,MAAQC,QAAUC,KAAA,yBAA+BC,aAAgBC,MAAA,oBAAAC,KAAA,mBAAAC,MAAA,WAAAC,SAAA,GAAwFC,KAAA,26HAA+jIR,MAAQC,QAAUC,KAAA,yBAA+BC,aAAgBC,MAAA,SAAAC,KAAA,mBAAAC,MAAA,OAAAC,SAAA,GAAyEC,KAAA,ohNAA4lNR,MAAQC,QAAUC,KAAA,4BAAkCC,aAAgBC,MAAA,+BAAAC,KAAA,mBAAAC,MAAA,sBAAAC,SAAA,GAA8GC,KAAA,6kYAAinZR,MAAQC,QAAUC,KAAA,2BAAiCC,aAAgBC,MAAA,eAAAC,KAAA,mBAAAC,MAAA,SAAAC,SAAA,GAAiFC,KAAA;IAA0qOR,MAAQC,QAAUC,KAAA,yBAA+BC,aAAgBC,MAAA,kBAAAC,KAAA,mBAAAC,MAAA,SAAAC,SAAA,GAAoFC,KAAA,w1IAA69IC,aAAgBC,OAAA,EAAAC,YAAA,EAAAC,MAAA","file":"path---1-db688be850577790c0d9.js","sourcesContent":["webpackJsonp([44611889172531],{\n\n/***/ \"./node_modules/json-loader/index.js!./.cache/json/1.json\":\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"allMarkdownRemark\":{\"edges\":[{\"node\":{\"fields\":{\"slug\":\"/posts/render-props/\"},\"frontmatter\":{\"title\":\"render prop正夯\",\"date\":\"2017-10-07T22:54\",\"tags\":[\"react\"],\"release\":true},\"html\":\"<snippet>\\n前陣了寫了跟HOC有關的文章，我從來沒用過mixin，雖然介紹了HOC，但自己使用的時候總覺得哪裡怪怪的，看了最近蠻紅的影片，終於恍然大悟，讓我們來介紹render props吧。\\n</snippet>\\n<p>一切要從Michael Jackson的<a href=\\\"https://www.youtube.com/watch?v=BcVAq3YFiuc\\\">影片</a>開始，或是你也可以看他寫的<a href=\\\"https://cdb.reacttraining.com/use-a-render-prop-50de598f11ce\\\">文章</a>。(他是react-router的創始人之一)</p>\\n<h3>mixin</h3>\\n<p>本來mixin的出現是為了code的reusable，這邊不特別介紹mixin的寫法，在我開始寫的時候，就已經不流行了。</p>\\n<h4>mixin的問題</h4>\\n<ol>\\n<li>\\n<p>不支持es6 class<br/>\\n沒錯，就是這點，所以我沒寫過，我也以前也只知道這點XDD。</p>\\n</li>\\n<li>\\n<p>無方向性<br/>\\n我是看文章翻譯的，簡言之，mixin使用了state，這樣會使被附加的component不知道state從哪裡來，尤其是一個component內用了不只一個mixin，code會變的implict。</p>\\n</li>\\n<li>\\n<p>命名衝突<br/>\\n如果有兩個mixin操作了相同名稱的state，這時候就會發生命名衝突，而且程式會直接掛掉，無法跑。</p>\\n</li>\\n</ol>\\n<h3>HOC</h3>\\n<p>採用了decorator的方式，跟\\bmixin相比支援es6 class。想了解的可以去翻我之前寫的文章。</p>\\n<h4>HOC的問題</h4>\\n<ol>\\n<li>\\n<p>一樣無方向性。</p>\\n</li>\\n<li>\\n<p>一樣命名衝突，但是可以跑，後面的會覆蓋前面的，react不會警告。比起mixin，這樣應該算更不好的缺點。</p>\\n</li>\\n</ol>\\n<h3>render prop</h3>\\n<p>在render裡面做處理，跟前兩種很不一樣的點，前面兩種被視為static composition，你只會做一次composition，在你create class的時候，而render prop為dynamic composition，每一次render的時候都會。我對這些是沒辨法自己想到見解，但我覺得這是蠻有道理的。</p>\\n<p>雖然我寫render prop，但其實常見的是Function as children?不過原理是一模一樣的，請安心使用。</p>\\n<p>試寫Function as children</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">A</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">chilren</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">B</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>A<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token punctuation\\\">{</span> AState <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n          <span class=\\\"token operator\\\">...</span>\\n        <span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>A<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>無方向性解決，你可以很簡單的從function的params得知是哪來的。</p>\\n<p>命名衝突解決，\\bfunction的params就像module or block一樣。隸屬於不同的params，永遠不會衝突。</p>\\n<p>唯一的問題(我想的)，因為變成兩個class，多了一個&#x3C;div>Root，我個人很討厭react的一堆div(炸)。</p>\\n<p>打完啦，我是看影片學的，影片裡面有更多有趣的說法，像是問題就像nail，而mixin就是hammer，然後敲敲敲，react-router其實不想寫HOC，但是因為社群需要\\b...建議聽的懂英文而有時間的可以看看影片，很精采。</p>\\n<p>我個人是覺得應該還是各有優缺點(雖然原文是render prop必勝)，HOC有recompose這個套件，render prop有react-powerplugin這個套件，目前在寫的時候目標是往render prop走，再看看會遇到什麼坑囉。</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/aws_s3_plugin/\"},\"frontmatter\":{\"title\":\"Webpack S3 plugin\",\"date\":\"2017-09-30T21:57\",\"tags\":[\"webpack\"],\"release\":true},\"html\":\"<p>承前幾天寫的文章，我也忘記為什麼突然search到這個plugin，看了一下可以自動化上傳，於是就跳下去了...</p>\\n<p>試了一陣子，了解了之後其實很簡單</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code>$ npm i webpack<span class=\\\"token operator\\\">-</span>s3<span class=\\\"token operator\\\">-</span>plugin\\n</code></pre>\\n      </div>\\n<p>webpack設定</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>NODE_ENV <span class=\\\"token operator\\\">===</span> <span class=\\\"token string\\\">'production'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  config<span class=\\\"token punctuation\\\">.</span>webpack<span class=\\\"token punctuation\\\">.</span>extra<span class=\\\"token punctuation\\\">.</span>plugins<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">push</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">S3Plugin</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// s3Options are required</span>\\n      s3Options<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        accessKeyId<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>AWS_ACCESS_KEY<span class=\\\"token punctuation\\\">,</span>\\n        secretAccessKey<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>AWS_SECRET_ACCESS_KEY<span class=\\\"token punctuation\\\">,</span>\\n        region<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>AWS_REGION<span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n      s3UploadOptions<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        Bucket<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>AWS_BUCKET<span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n      cloudfrontInvalidateOptions<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// Automatically invalidate your Cloudfront distribution cache every time you upload your code</span>\\n        DistributionId<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>CLOUDFRONT_DISTRIBUTION_ID<span class=\\\"token punctuation\\\">,</span>\\n        Items<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"/*\\\"</span><span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Bucket就是你S3的bucket，region請<a href=\\\"http://docs.aws.amazon.com/general/latest/gr/rande.html\\\">參照此</a></p>\\n<p>先講cloudfront部份，cloudfront有cache機制，預設是86400秒(一天)，如果要提前就要讓其失效(Invalidation)。關於失效的可以參考<a href=\\\"http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Invalidation.html#InvalidationLimits\\\">這裡</a>，看起來是算更新次數而不是更新檔案，1000次非常夠用。</p>\\n<p>再來就是accessId跟Key，一開始找不到在哪，問了同事要從IAM設一個新user，然後將AmazonS3FullAccess與CloudFrontFullAccess加上，不想用Invalidation不需要後面的權限，這樣就完成囉!!</p>\\n<p>其實我相信真的有在大量使用AWS的公司，應該都會有DevOps做自動化流程，這套件也是將s3 cli包進來做指令。因為之前是微軟體系的，然後後來對前端比較有興趣，這次稍微碰了一下，AWS很強大，在很多服務中很容易不知道該做什麼，真的S難QAQ</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/aws-s3-cdn-53/\"},\"frontmatter\":{\"title\":\"AWS簡略記\",\"date\":\"2017-09-28T21:49\",\"tags\":[\"AWS\"],\"release\":true},\"html\":\"<p><snippet>在公司做的頁面要上啦，說明要用AWS，跳坑研究一下(嗚嗚 需要devOps)，總共用了S3、CloudFront、Route53</snippet></p>\\n<h3>S3 (Simple Storage Service)</h3>\\n<p>雲端儲存，create一個bucket放置檔案，操作蠻簡單的。</p>\\n<p>因為是要用來架站用，所有東西都要能被外界使用，所以要設立權限。這邊的權限是bucket裡面的object，而非bucket本身。\\n\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 72.6161369193154%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB50lEQVQ4y62USU/bUBDH/Sm5gVBFeyugHiLU7cAiSlWJAIeeUCU+QA+tULkgAS00KrQJ0CK2xGv84iXBu+MQ+9/3bIrYAhR40l9vmfHPM/PG5pS6B8l04fg+olbrnIJmE14QwA/DW4srlLax+nMTa7+2sHqirxslHIoyLMeF62fAsqRgZb2Ib8y3uIXdioAwii4DB9++R3/+AwbGp/F0dAr9k7N4MjaD+eUCVFIDUVWEgY8vKwX0DVP7zBye5Wcx93E+zcLxvHPionaCqB2DzUmS4PO+jel1A/kfOia+ayjWArCR+WR+x3GCToNT7QiKxdSEH7XxrqAjt6jixRJBzycRC2UHTngMoRGm0twWWu1rgEQzQXQTmlFHtabDqB8hoLWI4xh3GZzjerAdD5ZNb5qumdianWW27JzV61bAR8/HIasEVSqiaRBlGbwg0IgNesP+jW1ysa243qExEMMEL4oo8zwFKvR2SQq0XfdG2CVgT240BbK6VYkKQZKxd3CA3392cFipwGw04Hdo7iuBj19NZED6VQiShGJpEzwvQKKR1nQdHk27SevHxMBHtn0a+ZXAvpdvoBAtdWKNyeZOtWMPM5t7Avq3987sue7cCHgaDXtzw7LuLa5r8HWa8v/8AK6t4UMD/wJEbmEEKFKajgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"s3-1\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/970dab34abfe188cfe51567b5c6f38be-a408b.png\\\"\\n        srcset=\\\"/static/970dab34abfe188cfe51567b5c6f38be-4eabf.png 148w,\\n/static/970dab34abfe188cfe51567b5c6f38be-5a375.png 295w,\\n/static/970dab34abfe188cfe51567b5c6f38be-a408b.png 590w,\\n/static/970dab34abfe188cfe51567b5c6f38be-24515.png 818w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  </p>\\n<p>可以使用AWS的policy generator即可。\\n\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 88.58195211786372%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8ElEQVQ4y5VUXY/aMBDMv25/RV/bh74cFflwHDsJf6CtrlKPqOiokHovqGppQkKQjgJCQgKmu84FHZejFyKNZrWOx7u2x5bv++h2u3BsB7ZtQwgfWuuzUDpCoELDSoeNcUtJASk8CMeBcF0Ij2Ih4Utl4IkAkljKAMLnnEYUxQ+IGrC4QsdxSdRFQOKB70EFAYJHUEodIYOQKtQVBxVXuYqtXq8HhpRUFYkLIYwIM+d41fqfNrBiRZOUj8h3CDYi6SCOwotETgTDMDy2xcxV1XHF6tgSt1i3zuN8CA3Bk0Qc49P1Da6TEb5+G+H7j5+4G6et8fHzl1NBXnU8HiPLMhR5gel0auI0TfFnMjFxWZY4HA7PIkmSJxUSWGS5XGKxWGA+nxP/xX6/x0sfC/b7fToUapNPtAYLrlYr3N8vDDO22217wacVFkVhBLI0MxXudju0+V4U5L1ar9cNQZ54kWCe52bPzm38OfAcIxiG7FOPTpidIYzgpWI1bm8HsLT24TodaOWSzQQmv39hNpsZcNvlvKS4NHE2zTErq7ikHO9x/R/fisGAro2xHSE0tnON4GazeRZ3yXuU2ejs+HA4rKxXW6m2m+e58NwP9EZ2IOnBeGzF/9muab0HuJ03uHr7Gp13r+A5V/QmavB9bfM4/AOTf8QyVpJ4BQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"s3-2\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/822f2cc9c4f0bb8735dd56ff463f9b90-a408b.png\\\"\\n        srcset=\\\"/static/822f2cc9c4f0bb8735dd56ff463f9b90-4eabf.png 148w,\\n/static/822f2cc9c4f0bb8735dd56ff463f9b90-5a375.png 295w,\\n/static/822f2cc9c4f0bb8735dd56ff463f9b90-a408b.png 590w,\\n/static/822f2cc9c4f0bb8735dd56ff463f9b90-9a0cc.png 885w,\\n/static/822f2cc9c4f0bb8735dd56ff463f9b90-c03c5.png 1086w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  </p>\\n<p>但要特別注意一點，在產生的Resource後面要加上/*，不然會發生<a href=\\\"https://stackoverflow.com/questions/44228422/s3-bucket-action-doesnt-apply-to-any-resources\\\">Action does not apply to any resource(s) in statement\\b</a>。</p>\\n<p>如果只是要架一個簡單的網站，到這邊配上Static website hosting就很夠了，使用c\\bdn的話這邊不需要hosting。</p>\\n<h3>CloudFront</h3>\\n<p>AWS提供的cdn服務</p>\\n<p>選擇web服務，Origin Domain Name選擇剛剛建立的S3 bucket，小設定不提，因為我要用cdn架站，再用Route53指過來，\\nDefault Root Object要寫entry，每個人應該都是index.html。Compress Objects Automatically可以加速，記得打開。另外一個重要的點，\\n跑SPA網站，網站的route是由前端控制，\\bhosting可以由Error Pages設定。\\n\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 45.16880093131548%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6ElEQVQoz5WS62qEMBCFff/n84eIl4Bso4n3ouL1NGfAslu07Q4cx8TJ55khnu/7SJIEQRBIDsMQcRyD+9yr6xrvhKeUQpZlDhJBpQqJg6VpiiiKkOc59n1/S97zomka9H2PcRwxTZPkeZ6xLMu3tm2TWtZdAmmTLywchkHEYlMYfDweKIoCXdeJ2D6hDK4vW+aDzqqqksOcm9Za9q4cHMchB/nTW+Cn+0iYNVZy27YIVP7r8MuyvAcyCCHMmAK1c6d1Lq7XdX0RXf4LeLZsjEHj4GzbWiutneIYzhn+CfwZd9finOFdfAF3ELtJH2HdHAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"cloudfront-1\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/c9d09870ac47be483a77c3a01239bd97-a408b.png\\\"\\n        srcset=\\\"/static/c9d09870ac47be483a77c3a01239bd97-4eabf.png 148w,\\n/static/c9d09870ac47be483a77c3a01239bd97-5a375.png 295w,\\n/static/c9d09870ac47be483a77c3a01239bd97-a408b.png 590w,\\n/static/c9d09870ac47be483a77c3a01239bd97-9a0cc.png 885w,\\n/static/c9d09870ac47be483a77c3a01239bd97-aa987.png 1180w,\\n/static/c9d09870ac47be483a77c3a01239bd97-ecaf3.png 1718w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n如此一來，如果有人直接打上路由，會被導到index並且正常的轉到該顯示的頁面。</p>\\n<h3>Route53</h3>\\n<p>AWS提供的dns控管服務</p>\\n<p>如果CloudFront要串到這裡，Alternate Domain Names (CNAMEs)要先打上Route53即將要給的domain，這邊好像沒什麼特別要注意的。CloudFront那邊可以設定ipv6，\\bipv4就選A然後選alias貼上CloudFront的網址(\\bxxxxx.cloudfront.net)，有ipv6就AAAA也設定一下。不確定是不是CloudFront要Delpoyed才能生效(\\bCloudFront每次進入in progess都要1x-2x分鐘)</p>\\n<p>PS.</p>\\n<p>還有遇到ssl問題啦(如果CloudFront走https又改domain)，結果custom ssl一直反白，Certificate只能用\\b<a href=\\\"https://stackoverflow.com/questions/28609262/unable-to-select-custom-ssl-certificate-stored-in-aws-iam\\\">美東</a>的啦</p>\\n<p>呼，總算弄完了!!</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/map_eventhandler/\"},\"frontmatter\":{\"title\":\"React with map中的eventhandler\",\"date\":\"2017-09-27T22:49\",\"tags\":[\"react\",\"javascript\"],\"release\":true},\"html\":\"<p>這個問題好像不常遇到，但是今天被同事問到的時候還一時回答不出來。</p>\\n<p>問題淺顯易懂，在map function裡面的params要何如何傳出來parent。</p>\\n<p>一下就回答用callback啊，但是仔細想一想要怎麼傳哬，囧。</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Parent</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token operator\\\">...</span>\\n  handleClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// what to do</span>\\n    <span class=\\\"token operator\\\">...</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">children</span><span class=\\\"token punctuation\\\">(</span> child <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n            <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// I want child props ex: ID</span>\\n            <span class=\\\"token operator\\\">&lt;</span>div onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>handleClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n          <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>先想了一個解決方法後開始google，看到這篇\\b<a href=\\\"https://stackoverflow.com/questions/29810914/react-js-onclick-cant-pass-value-to-method\\\">文章</a></p>\\n<h4>Easy way</h4>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">children</span><span class=\\\"token punctuation\\\">(</span> child <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token operator\\\">&lt;</span>div onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">handleClick</span><span class=\\\"token punctuation\\\">(</span>child<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n</code></pre>\\n      </div>\\n<p>這就是一般人直覺會想到的做法，但並不是太好。這網路上有很多文章，反正會有slightly performance issue(rebind與pure component等問題)，另外不好閱讀。</p>\\n<h4>Better Way</h4>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Parent</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token operator\\\">...</span>\\n  onChildClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token operator\\\">...</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">children</span><span class=\\\"token punctuation\\\">(</span> child <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n            <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// I want child props ex: ID</span>\\n            <span class=\\\"token operator\\\">&lt;</span>Child onChildClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>onChildClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n          <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Child</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token operator\\\">...</span>\\n  handleClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">onChildClick</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>handleClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>這例子看起來很蠢，不過現實中很少map裡面長這麼簡單的，以前都寫這種寫法，所以就不知道怎麼回答寫在同一層的XD。</p>\\n<p>不過我一開始認真想的是data-attr</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Parent</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token operator\\\">...</span>\\n  handleClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> cid <span class=\\\"token operator\\\">=</span> e<span class=\\\"token punctuation\\\">.</span>target<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getAttribute</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"data-cid\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">children</span><span class=\\\"token punctuation\\\">(</span> child <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n            <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// I want child props ex: ID</span>\\n            <span class=\\\"token operator\\\">&lt;</span>div data<span class=\\\"token operator\\\">-</span>cid<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span>child<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">}</span> onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>handleClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n          <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>隱約記得在哪個文章看過(react官方網站?!人老了)</p>\\n<p>最後，因為專案都用semantic-react啦\\b...可以直接傳出data，用久了難怪忘光XDD，看了一下source code，使用lodash的invoke</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code>handleClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">{</span> disabled <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props\\n\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>disabled<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    e<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">preventDefault</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token keyword\\\">return</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  _<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">invoke</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'onClick'</span><span class=\\\"token punctuation\\\">,</span> e<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>也算學到了新東西!!</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/hoc_n_decorator/\"},\"frontmatter\":{\"title\":\"HOC in React\",\"date\":\"2017-09-17T16:48\",\"tags\":[\"react\"],\"release\":true},\"html\":\"<p><snippet>React強調composition > inheritance，利用許多小的component組合成大的comoponent</snippet></p>\\n<p>其中，High-order component也是代替inheritance的一種方式。HOC為一個function，接收一個component為params，然後回傳另一個component。最常見的HOC就是react-redux的connect，此function幫助整個app可以綁定唯一的store，將邏輯與UI分離卻又很方便的建立component。</p>\\n<blockquote>\\n<p>hocFactory:: W: React.Component => E: React.Component</p>\\n</blockquote>\\n<p>對我來說，最大的好處就是不同的component可以使用HOC掛載相同的行為或屬性。</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">const</span> Logger <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>WrappedComponent<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n\\n <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ClickLogger</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    handleClick <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token operator\\\">&lt;</span>WrappedComponent <span class=\\\"token punctuation\\\">{</span><span class=\\\"token operator\\\">...</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">}</span> onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>handleClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>上述的function可以綁定任何的component，也是為什麼composition比inheritance好的原因。不過這其實這應該回到oo design討論，若只是為了code reuse，完全不應該使用inheritance。\\binheritance分為\\bimplementation inheritance（實作繼承)與interface inheritance（介面繼承)，我們應該為了interface而繼承(is-a的概念)，而implementation inheritance則使用composition取代。</p>\\n<p>並且，inheritance擁有最高的耦合度，在現在流行的functional progaming完全相反，或者說，functional progaming的一部份目的本來就是為了降低耦合度。</p>\\n<p>另外一個使用情境就是對props做一些處理，例如修改或是新增props (props proxy)</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">const</span> Loggin <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>WrappedComponent<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">LogginWrap</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">const</span> newProps <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        user<span class=\\\"token punctuation\\\">:</span> currentLoggedInUser\\n      <span class=\\\"token punctuation\\\">}</span>\\n\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>WrappedComponent\\n        <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token operator\\\">...</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">,</span>\\n          organization<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>organization<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">toUpperCase</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token operator\\\">...</span>newProps <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p><a href=\\\"https://medium.com/@franleplant/react-higher-order-components-in-depth-cf9032ee6c3e\\\">這篇文章</a>還有更多應用像是inheritance inversion(看了一下很有趣，debug part看起來很好用，另一個不知道使用境)，然後naming超實用!!</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code>HOC<span class=\\\"token punctuation\\\">.</span>displayName <span class=\\\"token operator\\\">=</span> <span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`HOC(</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token function\\\">getDisplayName</span><span class=\\\"token punctuation\\\">(</span>WrappedComponent<span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">)`</span></span>\\n<span class=\\\"token comment\\\" spellcheck=\\\"true\\\">//or</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">HOC</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\"><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">static</span> displayName <span class=\\\"token operator\\\">=</span> <span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`HOC(</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token function\\\">getDisplayName</span><span class=\\\"token punctuation\\\">(</span>WrappedComponent<span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">)`</span></span>\\n  <span class=\\\"token operator\\\">...</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Decorator與Recompose研究一下，下一篇再介紹。</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/react_context/\"},\"frontmatter\":{\"title\":\"React context認識\",\"date\":\"2017-09-09T14:55\",\"tags\":[\"react\"],\"release\":true},\"html\":\"<snippet>\\ncontext是一個很少被使用的屬性，我想一方面在react的教學頁面不會特別提到這點，另一方面介紹的頁面就先警告一般人不要使用。一開始我也是看到警告就沒有研究了，不過在實際遇到情境與研究了HOC以後，確實是挺有趣的。\\n</snippet>\\n<h3>Context</h3>\\n<p>react的<a href=\\\"https://facebook.github.io/react/docs/context.html\\\">官方文章</a>中，會告訴你props要傳遞每個component很麻煩，所以有了context這個power api，不過下一秒又跟說不建議使用XD</p>\\n<p>context的用法也相當簡單，這邊不太細講整體用法，請自己看官方文件</p>\\n<p>總之，在你的context container加上getChildContext與childContextTypes</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Parent</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">getChildContext</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">{</span>key<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"value\\\"</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token operator\\\">...</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nParent<span class=\\\"token punctuation\\\">.</span>childContextTypes <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  key<span class=\\\"token punctuation\\\">:</span> PropTypes<span class=\\\"token operator\\\">...</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>在你的child加上contextTypes，最後呼叫this.context使用</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Child</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">{</span> key <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>context<span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token operator\\\">...</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nChild<span class=\\\"token punctuation\\\">.</span>childContextTypes <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  key<span class=\\\"token punctuation\\\">:</span> PropTypes<span class=\\\"token operator\\\">...</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>為什麼不要使用context的原因</p>\\n<ol>\\n<li>\\n<p>很難找到source<br/>\\n這與react的特色完全相抵觸，react強調的是props的傳遞與資料的明確性，你的所有東西會照著flow走。而context打破了這個規則，你必須去翻你的source code。當然現在的IDE都很猛，可能也不是很care，但是跟原生react比，確實有這個問題。</p>\\n</li>\\n<li>\\n<p>造成耦合度<br/>\\n原本的component只要接收props就可以在任何地方，任何專案中使用，但是一但使用了context，你必須綁定某個parent，這樣是增加了耦合度。</p>\\n</li>\\n<li>\\n<p>難以test<br/>\\n如果有在寫test，因為component的data要從context取得而非props，實際想想就覺得很困難。</p>\\n</li>\\n<li>\\n<p>語意不清與render問題<br/>\\n從setState你可以馬上看的懂state要改變了，但是getChildContext是跟著setState一起的，這本身語意上就不清晰，另外因為getChildContext這個method會在props or state改變的時候被呼叫，所以你要改變context的值應該使用props or state(但這其實就是不好的做法)。<br/>\\n因為child更新context會被shouldCompoentUpdate所擋下來。這邊並不是指child本身shouldCompoentUpdate，而是parent到child之間所有的component若是有實作shouldCompoentUpdate且return false，更大的機率可能用了PureComponent，這樣就會導致child更新失敗。<br/></p>\\n<p>所以所以重點來了</p>\\n<ol>\\n<li>context不應該被改變(or shalow immutable)。</li>\\n<li>承上，context只應該在constructor的時候收到一次。</li>\\n</ol>\\n<p>基於以上理由我們可以</p>\\n<ol>\\n<li>將context由props or state搬到外面轉為Dependency injection。</li>\\n<li>加上observe pattern，訂閱Dependency Object，當Object改變時，主動告知底下改變。</li>\\n</ol>\\n<p><a href=\\\"https://medium.com/@mweststrate/how-to-safely-use-react-context-b7e343eff076\\\">這篇必看!!!</a></p>\\n</li>\\n</ol>\\n<p>打完這篇我也將專案中的context先拆掉了(因為本來就可以用provider+hoc的方式處理)，但是使用provider本身也就有相當的耦合度，主要還是看架構，再來決定你的component要如何設計囉。</p>\"}}]}},\"pathContext\":{\"offset\":6,\"paginations\":6,\"total\":21}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---1-db688be850577790c0d9.js","module.exports = {\"data\":{\"allMarkdownRemark\":{\"edges\":[{\"node\":{\"fields\":{\"slug\":\"/posts/render-props/\"},\"frontmatter\":{\"title\":\"render prop正夯\",\"date\":\"2017-10-07T22:54\",\"tags\":[\"react\"],\"release\":true},\"html\":\"<snippet>\\n前陣了寫了跟HOC有關的文章，我從來沒用過mixin，雖然介紹了HOC，但自己使用的時候總覺得哪裡怪怪的，看了最近蠻紅的影片，終於恍然大悟，讓我們來介紹render props吧。\\n</snippet>\\n<p>一切要從Michael Jackson的<a href=\\\"https://www.youtube.com/watch?v=BcVAq3YFiuc\\\">影片</a>開始，或是你也可以看他寫的<a href=\\\"https://cdb.reacttraining.com/use-a-render-prop-50de598f11ce\\\">文章</a>。(他是react-router的創始人之一)</p>\\n<h3>mixin</h3>\\n<p>本來mixin的出現是為了code的reusable，這邊不特別介紹mixin的寫法，在我開始寫的時候，就已經不流行了。</p>\\n<h4>mixin的問題</h4>\\n<ol>\\n<li>\\n<p>不支持es6 class<br/>\\n沒錯，就是這點，所以我沒寫過，我也以前也只知道這點XDD。</p>\\n</li>\\n<li>\\n<p>無方向性<br/>\\n我是看文章翻譯的，簡言之，mixin使用了state，這樣會使被附加的component不知道state從哪裡來，尤其是一個component內用了不只一個mixin，code會變的implict。</p>\\n</li>\\n<li>\\n<p>命名衝突<br/>\\n如果有兩個mixin操作了相同名稱的state，這時候就會發生命名衝突，而且程式會直接掛掉，無法跑。</p>\\n</li>\\n</ol>\\n<h3>HOC</h3>\\n<p>採用了decorator的方式，跟\\bmixin相比支援es6 class。想了解的可以去翻我之前寫的文章。</p>\\n<h4>HOC的問題</h4>\\n<ol>\\n<li>\\n<p>一樣無方向性。</p>\\n</li>\\n<li>\\n<p>一樣命名衝突，但是可以跑，後面的會覆蓋前面的，react不會警告。比起mixin，這樣應該算更不好的缺點。</p>\\n</li>\\n</ol>\\n<h3>render prop</h3>\\n<p>在render裡面做處理，跟前兩種很不一樣的點，前面兩種被視為static composition，你只會做一次composition，在你create class的時候，而render prop為dynamic composition，每一次render的時候都會。我對這些是沒辨法自己想到見解，但我覺得這是蠻有道理的。</p>\\n<p>雖然我寫render prop，但其實常見的是Function as children?不過原理是一模一樣的，請安心使用。</p>\\n<p>試寫Function as children</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">A</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">chilren</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">B</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>A<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token punctuation\\\">{</span> AState <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n          <span class=\\\"token operator\\\">...</span>\\n        <span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>A<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>無方向性解決，你可以很簡單的從function的params得知是哪來的。</p>\\n<p>命名衝突解決，\\bfunction的params就像module or block一樣。隸屬於不同的params，永遠不會衝突。</p>\\n<p>唯一的問題(我想的)，因為變成兩個class，多了一個&#x3C;div>Root，我個人很討厭react的一堆div(炸)。</p>\\n<p>打完啦，我是看影片學的，影片裡面有更多有趣的說法，像是問題就像nail，而mixin就是hammer，然後敲敲敲，react-router其實不想寫HOC，但是因為社群需要\\b...建議聽的懂英文而有時間的可以看看影片，很精采。</p>\\n<p>我個人是覺得應該還是各有優缺點(雖然原文是render prop必勝)，HOC有recompose這個套件，render prop有react-powerplugin這個套件，目前在寫的時候目標是往render prop走，再看看會遇到什麼坑囉。</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/aws_s3_plugin/\"},\"frontmatter\":{\"title\":\"Webpack S3 plugin\",\"date\":\"2017-09-30T21:57\",\"tags\":[\"webpack\"],\"release\":true},\"html\":\"<p>承前幾天寫的文章，我也忘記為什麼突然search到這個plugin，看了一下可以自動化上傳，於是就跳下去了...</p>\\n<p>試了一陣子，了解了之後其實很簡單</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code>$ npm i webpack<span class=\\\"token operator\\\">-</span>s3<span class=\\\"token operator\\\">-</span>plugin\\n</code></pre>\\n      </div>\\n<p>webpack設定</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>NODE_ENV <span class=\\\"token operator\\\">===</span> <span class=\\\"token string\\\">'production'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  config<span class=\\\"token punctuation\\\">.</span>webpack<span class=\\\"token punctuation\\\">.</span>extra<span class=\\\"token punctuation\\\">.</span>plugins<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">push</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">S3Plugin</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// s3Options are required</span>\\n      s3Options<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        accessKeyId<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>AWS_ACCESS_KEY<span class=\\\"token punctuation\\\">,</span>\\n        secretAccessKey<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>AWS_SECRET_ACCESS_KEY<span class=\\\"token punctuation\\\">,</span>\\n        region<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>AWS_REGION<span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n      s3UploadOptions<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        Bucket<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>AWS_BUCKET<span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n      cloudfrontInvalidateOptions<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// Automatically invalidate your Cloudfront distribution cache every time you upload your code</span>\\n        DistributionId<span class=\\\"token punctuation\\\">:</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span>CLOUDFRONT_DISTRIBUTION_ID<span class=\\\"token punctuation\\\">,</span>\\n        Items<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"/*\\\"</span><span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Bucket就是你S3的bucket，region請<a href=\\\"http://docs.aws.amazon.com/general/latest/gr/rande.html\\\">參照此</a></p>\\n<p>先講cloudfront部份，cloudfront有cache機制，預設是86400秒(一天)，如果要提前就要讓其失效(Invalidation)。關於失效的可以參考<a href=\\\"http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Invalidation.html#InvalidationLimits\\\">這裡</a>，看起來是算更新次數而不是更新檔案，1000次非常夠用。</p>\\n<p>再來就是accessId跟Key，一開始找不到在哪，問了同事要從IAM設一個新user，然後將AmazonS3FullAccess與CloudFrontFullAccess加上，不想用Invalidation不需要後面的權限，這樣就完成囉!!</p>\\n<p>其實我相信真的有在大量使用AWS的公司，應該都會有DevOps做自動化流程，這套件也是將s3 cli包進來做指令。因為之前是微軟體系的，然後後來對前端比較有興趣，這次稍微碰了一下，AWS很強大，在很多服務中很容易不知道該做什麼，真的S難QAQ</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/aws-s3-cdn-53/\"},\"frontmatter\":{\"title\":\"AWS簡略記\",\"date\":\"2017-09-28T21:49\",\"tags\":[\"AWS\"],\"release\":true},\"html\":\"<p><snippet>在公司做的頁面要上啦，說明要用AWS，跳坑研究一下(嗚嗚 需要devOps)，總共用了S3、CloudFront、Route53</snippet></p>\\n<h3>S3 (Simple Storage Service)</h3>\\n<p>雲端儲存，create一個bucket放置檔案，操作蠻簡單的。</p>\\n<p>因為是要用來架站用，所有東西都要能被外界使用，所以要設立權限。這邊的權限是bucket裡面的object，而非bucket本身。\\n\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 72.6161369193154%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB50lEQVQ4y62USU/bUBDH/Sm5gVBFeyugHiLU7cAiSlWJAIeeUCU+QA+tULkgAS00KrQJ0CK2xGv84iXBu+MQ+9/3bIrYAhR40l9vmfHPM/PG5pS6B8l04fg+olbrnIJmE14QwA/DW4srlLax+nMTa7+2sHqirxslHIoyLMeF62fAsqRgZb2Ib8y3uIXdioAwii4DB9++R3/+AwbGp/F0dAr9k7N4MjaD+eUCVFIDUVWEgY8vKwX0DVP7zBye5Wcx93E+zcLxvHPionaCqB2DzUmS4PO+jel1A/kfOia+ayjWArCR+WR+x3GCToNT7QiKxdSEH7XxrqAjt6jixRJBzycRC2UHTngMoRGm0twWWu1rgEQzQXQTmlFHtabDqB8hoLWI4xh3GZzjerAdD5ZNb5qumdianWW27JzV61bAR8/HIasEVSqiaRBlGbwg0IgNesP+jW1ysa243qExEMMEL4oo8zwFKvR2SQq0XfdG2CVgT240BbK6VYkKQZKxd3CA3392cFipwGw04Hdo7iuBj19NZED6VQiShGJpEzwvQKKR1nQdHk27SevHxMBHtn0a+ZXAvpdvoBAtdWKNyeZOtWMPM5t7Avq3987sue7cCHgaDXtzw7LuLa5r8HWa8v/8AK6t4UMD/wJEbmEEKFKajgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"s3-1\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/970dab34abfe188cfe51567b5c6f38be-a408b.png\\\"\\n        srcset=\\\"/static/970dab34abfe188cfe51567b5c6f38be-4eabf.png 148w,\\n/static/970dab34abfe188cfe51567b5c6f38be-5a375.png 295w,\\n/static/970dab34abfe188cfe51567b5c6f38be-a408b.png 590w,\\n/static/970dab34abfe188cfe51567b5c6f38be-24515.png 818w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  </p>\\n<p>可以使用AWS的policy generator即可。\\n\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 88.58195211786372%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8ElEQVQ4y5VUXY/aMBDMv25/RV/bh74cFflwHDsJf6CtrlKPqOiokHovqGppQkKQjgJCQgKmu84FHZejFyKNZrWOx7u2x5bv++h2u3BsB7ZtQwgfWuuzUDpCoELDSoeNcUtJASk8CMeBcF0Ij2Ih4Utl4IkAkljKAMLnnEYUxQ+IGrC4QsdxSdRFQOKB70EFAYJHUEodIYOQKtQVBxVXuYqtXq8HhpRUFYkLIYwIM+d41fqfNrBiRZOUj8h3CDYi6SCOwotETgTDMDy2xcxV1XHF6tgSt1i3zuN8CA3Bk0Qc49P1Da6TEb5+G+H7j5+4G6et8fHzl1NBXnU8HiPLMhR5gel0auI0TfFnMjFxWZY4HA7PIkmSJxUSWGS5XGKxWGA+nxP/xX6/x0sfC/b7fToUapNPtAYLrlYr3N8vDDO22217wacVFkVhBLI0MxXudju0+V4U5L1ar9cNQZ54kWCe52bPzm38OfAcIxiG7FOPTpidIYzgpWI1bm8HsLT24TodaOWSzQQmv39hNpsZcNvlvKS4NHE2zTErq7ikHO9x/R/fisGAro2xHSE0tnON4GazeRZ3yXuU2ejs+HA4rKxXW6m2m+e58NwP9EZ2IOnBeGzF/9muab0HuJ03uHr7Gp13r+A5V/QmavB9bfM4/AOTf8QyVpJ4BQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"s3-2\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/822f2cc9c4f0bb8735dd56ff463f9b90-a408b.png\\\"\\n        srcset=\\\"/static/822f2cc9c4f0bb8735dd56ff463f9b90-4eabf.png 148w,\\n/static/822f2cc9c4f0bb8735dd56ff463f9b90-5a375.png 295w,\\n/static/822f2cc9c4f0bb8735dd56ff463f9b90-a408b.png 590w,\\n/static/822f2cc9c4f0bb8735dd56ff463f9b90-9a0cc.png 885w,\\n/static/822f2cc9c4f0bb8735dd56ff463f9b90-c03c5.png 1086w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  </p>\\n<p>但要特別注意一點，在產生的Resource後面要加上/*，不然會發生<a href=\\\"https://stackoverflow.com/questions/44228422/s3-bucket-action-doesnt-apply-to-any-resources\\\">Action does not apply to any resource(s) in statement\\b</a>。</p>\\n<p>如果只是要架一個簡單的網站，到這邊配上Static website hosting就很夠了，使用c\\bdn的話這邊不需要hosting。</p>\\n<h3>CloudFront</h3>\\n<p>AWS提供的cdn服務</p>\\n<p>選擇web服務，Origin Domain Name選擇剛剛建立的S3 bucket，小設定不提，因為我要用cdn架站，再用Route53指過來，\\nDefault Root Object要寫entry，每個人應該都是index.html。Compress Objects Automatically可以加速，記得打開。另外一個重要的點，\\n跑SPA網站，網站的route是由前端控制，\\bhosting可以由Error Pages設定。\\n\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 45.16880093131548%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6ElEQVQoz5WS62qEMBCFff/n84eIl4Bso4n3ouL1NGfAslu07Q4cx8TJ55khnu/7SJIEQRBIDsMQcRyD+9yr6xrvhKeUQpZlDhJBpQqJg6VpiiiKkOc59n1/S97zomka9H2PcRwxTZPkeZ6xLMu3tm2TWtZdAmmTLywchkHEYlMYfDweKIoCXdeJ2D6hDK4vW+aDzqqqksOcm9Za9q4cHMchB/nTW+Cn+0iYNVZy27YIVP7r8MuyvAcyCCHMmAK1c6d1Lq7XdX0RXf4LeLZsjEHj4GzbWiutneIYzhn+CfwZd9finOFdfAF3ELtJH2HdHAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"cloudfront-1\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/c9d09870ac47be483a77c3a01239bd97-a408b.png\\\"\\n        srcset=\\\"/static/c9d09870ac47be483a77c3a01239bd97-4eabf.png 148w,\\n/static/c9d09870ac47be483a77c3a01239bd97-5a375.png 295w,\\n/static/c9d09870ac47be483a77c3a01239bd97-a408b.png 590w,\\n/static/c9d09870ac47be483a77c3a01239bd97-9a0cc.png 885w,\\n/static/c9d09870ac47be483a77c3a01239bd97-aa987.png 1180w,\\n/static/c9d09870ac47be483a77c3a01239bd97-ecaf3.png 1718w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n如此一來，如果有人直接打上路由，會被導到index並且正常的轉到該顯示的頁面。</p>\\n<h3>Route53</h3>\\n<p>AWS提供的dns控管服務</p>\\n<p>如果CloudFront要串到這裡，Alternate Domain Names (CNAMEs)要先打上Route53即將要給的domain，這邊好像沒什麼特別要注意的。CloudFront那邊可以設定ipv6，\\bipv4就選A然後選alias貼上CloudFront的網址(\\bxxxxx.cloudfront.net)，有ipv6就AAAA也設定一下。不確定是不是CloudFront要Delpoyed才能生效(\\bCloudFront每次進入in progess都要1x-2x分鐘)</p>\\n<p>PS.</p>\\n<p>還有遇到ssl問題啦(如果CloudFront走https又改domain)，結果custom ssl一直反白，Certificate只能用\\b<a href=\\\"https://stackoverflow.com/questions/28609262/unable-to-select-custom-ssl-certificate-stored-in-aws-iam\\\">美東</a>的啦</p>\\n<p>呼，總算弄完了!!</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/map_eventhandler/\"},\"frontmatter\":{\"title\":\"React with map中的eventhandler\",\"date\":\"2017-09-27T22:49\",\"tags\":[\"react\",\"javascript\"],\"release\":true},\"html\":\"<p>這個問題好像不常遇到，但是今天被同事問到的時候還一時回答不出來。</p>\\n<p>問題淺顯易懂，在map function裡面的params要何如何傳出來parent。</p>\\n<p>一下就回答用callback啊，但是仔細想一想要怎麼傳哬，囧。</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Parent</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token operator\\\">...</span>\\n  handleClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// what to do</span>\\n    <span class=\\\"token operator\\\">...</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">children</span><span class=\\\"token punctuation\\\">(</span> child <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n            <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// I want child props ex: ID</span>\\n            <span class=\\\"token operator\\\">&lt;</span>div onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>handleClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n          <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>先想了一個解決方法後開始google，看到這篇\\b<a href=\\\"https://stackoverflow.com/questions/29810914/react-js-onclick-cant-pass-value-to-method\\\">文章</a></p>\\n<h4>Easy way</h4>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">children</span><span class=\\\"token punctuation\\\">(</span> child <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token operator\\\">&lt;</span>div onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">handleClick</span><span class=\\\"token punctuation\\\">(</span>child<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n</code></pre>\\n      </div>\\n<p>這就是一般人直覺會想到的做法，但並不是太好。這網路上有很多文章，反正會有slightly performance issue(rebind與pure component等問題)，另外不好閱讀。</p>\\n<h4>Better Way</h4>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Parent</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token operator\\\">...</span>\\n  onChildClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token operator\\\">...</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">children</span><span class=\\\"token punctuation\\\">(</span> child <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n            <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// I want child props ex: ID</span>\\n            <span class=\\\"token operator\\\">&lt;</span>Child onChildClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>onChildClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n          <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Child</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token operator\\\">...</span>\\n  handleClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">onChildClick</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>handleClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>這例子看起來很蠢，不過現實中很少map裡面長這麼簡單的，以前都寫這種寫法，所以就不知道怎麼回答寫在同一層的XD。</p>\\n<p>不過我一開始認真想的是data-attr</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Parent</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token operator\\\">...</span>\\n  handleClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> cid <span class=\\\"token operator\\\">=</span> e<span class=\\\"token punctuation\\\">.</span>target<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getAttribute</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"data-cid\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">children</span><span class=\\\"token punctuation\\\">(</span> child <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n            <span class=\\\"token comment\\\" spellcheck=\\\"true\\\">// I want child props ex: ID</span>\\n            <span class=\\\"token operator\\\">&lt;</span>div data<span class=\\\"token operator\\\">-</span>cid<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span>child<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">}</span> onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>handleClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n          <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>隱約記得在哪個文章看過(react官方網站?!人老了)</p>\\n<p>最後，因為專案都用semantic-react啦\\b...可以直接傳出data，用久了難怪忘光XDD，看了一下source code，使用lodash的invoke</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code>handleClick <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">{</span> disabled <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props\\n\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>disabled<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    e<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">preventDefault</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token keyword\\\">return</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  _<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">invoke</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'onClick'</span><span class=\\\"token punctuation\\\">,</span> e<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>也算學到了新東西!!</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/hoc_n_decorator/\"},\"frontmatter\":{\"title\":\"HOC in React\",\"date\":\"2017-09-17T16:48\",\"tags\":[\"react\"],\"release\":true},\"html\":\"<p><snippet>React強調composition > inheritance，利用許多小的component組合成大的comoponent</snippet></p>\\n<p>其中，High-order component也是代替inheritance的一種方式。HOC為一個function，接收一個component為params，然後回傳另一個component。最常見的HOC就是react-redux的connect，此function幫助整個app可以綁定唯一的store，將邏輯與UI分離卻又很方便的建立component。</p>\\n<blockquote>\\n<p>hocFactory:: W: React.Component => E: React.Component</p>\\n</blockquote>\\n<p>對我來說，最大的好處就是不同的component可以使用HOC掛載相同的行為或屬性。</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">const</span> Logger <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>WrappedComponent<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n\\n <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ClickLogger</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    handleClick <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>e<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token operator\\\">&lt;</span>WrappedComponent <span class=\\\"token punctuation\\\">{</span><span class=\\\"token operator\\\">...</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">}</span> onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>handleClick<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>上述的function可以綁定任何的component，也是為什麼composition比inheritance好的原因。不過這其實這應該回到oo design討論，若只是為了code reuse，完全不應該使用inheritance。\\binheritance分為\\bimplementation inheritance（實作繼承)與interface inheritance（介面繼承)，我們應該為了interface而繼承(is-a的概念)，而implementation inheritance則使用composition取代。</p>\\n<p>並且，inheritance擁有最高的耦合度，在現在流行的functional progaming完全相反，或者說，functional progaming的一部份目的本來就是為了降低耦合度。</p>\\n<p>另外一個使用情境就是對props做一些處理，例如修改或是新增props (props proxy)</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">const</span> Loggin <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>WrappedComponent<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">LogginWrap</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">const</span> newProps <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        user<span class=\\\"token punctuation\\\">:</span> currentLoggedInUser\\n      <span class=\\\"token punctuation\\\">}</span>\\n\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>WrappedComponent\\n        <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token operator\\\">...</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">,</span>\\n          organization<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>organization<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">toUpperCase</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token operator\\\">...</span>newProps <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p><a href=\\\"https://medium.com/@franleplant/react-higher-order-components-in-depth-cf9032ee6c3e\\\">這篇文章</a>還有更多應用像是inheritance inversion(看了一下很有趣，debug part看起來很好用，另一個不知道使用境)，然後naming超實用!!</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code>HOC<span class=\\\"token punctuation\\\">.</span>displayName <span class=\\\"token operator\\\">=</span> <span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`HOC(</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token function\\\">getDisplayName</span><span class=\\\"token punctuation\\\">(</span>WrappedComponent<span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">)`</span></span>\\n<span class=\\\"token comment\\\" spellcheck=\\\"true\\\">//or</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">HOC</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\"><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">static</span> displayName <span class=\\\"token operator\\\">=</span> <span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`HOC(</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token function\\\">getDisplayName</span><span class=\\\"token punctuation\\\">(</span>WrappedComponent<span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">)`</span></span>\\n  <span class=\\\"token operator\\\">...</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Decorator與Recompose研究一下，下一篇再介紹。</p>\"}},{\"node\":{\"fields\":{\"slug\":\"/posts/react_context/\"},\"frontmatter\":{\"title\":\"React context認識\",\"date\":\"2017-09-09T14:55\",\"tags\":[\"react\"],\"release\":true},\"html\":\"<snippet>\\ncontext是一個很少被使用的屬性，我想一方面在react的教學頁面不會特別提到這點，另一方面介紹的頁面就先警告一般人不要使用。一開始我也是看到警告就沒有研究了，不過在實際遇到情境與研究了HOC以後，確實是挺有趣的。\\n</snippet>\\n<h3>Context</h3>\\n<p>react的<a href=\\\"https://facebook.github.io/react/docs/context.html\\\">官方文章</a>中，會告訴你props要傳遞每個component很麻煩，所以有了context這個power api，不過下一秒又跟說不建議使用XD</p>\\n<p>context的用法也相當簡單，這邊不太細講整體用法，請自己看官方文件</p>\\n<p>總之，在你的context container加上getChildContext與childContextTypes</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Parent</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">getChildContext</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">{</span>key<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"value\\\"</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token operator\\\">...</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nParent<span class=\\\"token punctuation\\\">.</span>childContextTypes <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  key<span class=\\\"token punctuation\\\">:</span> PropTypes<span class=\\\"token operator\\\">...</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>在你的child加上contextTypes，最後呼叫this.context使用</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Child</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">{</span> key <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>context<span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token operator\\\">...</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nChild<span class=\\\"token punctuation\\\">.</span>childContextTypes <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  key<span class=\\\"token punctuation\\\">:</span> PropTypes<span class=\\\"token operator\\\">...</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>為什麼不要使用context的原因</p>\\n<ol>\\n<li>\\n<p>很難找到source<br/>\\n這與react的特色完全相抵觸，react強調的是props的傳遞與資料的明確性，你的所有東西會照著flow走。而context打破了這個規則，你必須去翻你的source code。當然現在的IDE都很猛，可能也不是很care，但是跟原生react比，確實有這個問題。</p>\\n</li>\\n<li>\\n<p>造成耦合度<br/>\\n原本的component只要接收props就可以在任何地方，任何專案中使用，但是一但使用了context，你必須綁定某個parent，這樣是增加了耦合度。</p>\\n</li>\\n<li>\\n<p>難以test<br/>\\n如果有在寫test，因為component的data要從context取得而非props，實際想想就覺得很困難。</p>\\n</li>\\n<li>\\n<p>語意不清與render問題<br/>\\n從setState你可以馬上看的懂state要改變了，但是getChildContext是跟著setState一起的，這本身語意上就不清晰，另外因為getChildContext這個method會在props or state改變的時候被呼叫，所以你要改變context的值應該使用props or state(但這其實就是不好的做法)。<br/>\\n因為child更新context會被shouldCompoentUpdate所擋下來。這邊並不是指child本身shouldCompoentUpdate，而是parent到child之間所有的component若是有實作shouldCompoentUpdate且return false，更大的機率可能用了PureComponent，這樣就會導致child更新失敗。<br/></p>\\n<p>所以所以重點來了</p>\\n<ol>\\n<li>context不應該被改變(or shalow immutable)。</li>\\n<li>承上，context只應該在constructor的時候收到一次。</li>\\n</ol>\\n<p>基於以上理由我們可以</p>\\n<ol>\\n<li>將context由props or state搬到外面轉為Dependency injection。</li>\\n<li>加上observe pattern，訂閱Dependency Object，當Object改變時，主動告知底下改變。</li>\\n</ol>\\n<p><a href=\\\"https://medium.com/@mweststrate/how-to-safely-use-react-context-b7e343eff076\\\">這篇必看!!!</a></p>\\n</li>\\n</ol>\\n<p>打完這篇我也將專案中的context先拆掉了(因為本來就可以用provider+hoc的方式處理)，但是使用provider本身也就有相當的耦合度，主要還是看架構，再來決定你的component要如何設計囉。</p>\"}}]}},\"pathContext\":{\"offset\":6,\"paginations\":6,\"total\":21}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/1.json\n// module id = ./node_modules/json-loader/index.js!./.cache/json/1.json\n// module chunks = 44611889172531"],"sourceRoot":""}