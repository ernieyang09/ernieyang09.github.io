{"version":3,"sources":["webpack:///path---posts-script-after-body-273cb8b82e281a99e166.js","webpack:///./.cache/json/posts-script-after-body.json"],"names":["webpackJsonp","479","module","exports","data","site","siteMetadata","title","author","markdownRemark","id","html","fields","slug","frontmatter","date","tags","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,cAAgBC,MAAA,OAAAC,OAAA,eAAsCC,gBAAmBC,GAAA,yIAAAC,KAAA,0qRAA64QC,QAA0pBC,KAAA,6BAAmCC,aAAgBP,MAAA,4BAAAQ,KAAA,mBAAAC,MAAA,eAAoFC,aAAgBJ,KAAA","file":"path---posts-script-after-body-273cb8b82e281a99e166.js","sourcesContent":["webpackJsonp([27383442544989],{\n\n/***/ 479:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"前端小誌\",\"author\":\"Ernie Yang\"}},\"markdownRemark\":{\"id\":\"/Users/ernieyang09/Desktop/workspace/gatsby-blog/src/pages/posts/2018/09/0902--script-after-body.md absPath of file >>> MarkdownRemark\",\"html\":\"<snippet>\\n  天啊，原本預計一個月一篇文章，由於本人跑去當了full stack，變得太忙了，周末只想好好休息耍廢。最近新專案終於要上了，處理的也差不多了。只剩一些小bug與performance需要調整我會想辨法，我會努力把文章補回。未來再來看看要不要加一些後端文章(那就不是前端小誌了XD)\\n</snippet>\\n<p>這篇先來個簡單的東西吧，就是script tag, link到底要放在html的哪裡呢</p>\\n<p>直接先講結論</p>\\n<blockquote>\\n<p>放在body之後絕對沒毛病</p>\\n</blockquote>\\n<p>從最簡單講起，大多數人一定知道loading js會block browser的render機制</p>\\n<p>很多<a href=\\\"/posts/browser-mechanic/\\\">之前</a>的概念要知道</p>\\n<blockquote>\\n<p>GUI與JS \\bthread是戶斥的，因為當repaint的時候會觸發GUI \\bthread，但JS執行後很有可能會造成多次repaint，於是乎JS在執行的時候會先block GUI thread，待JS結束後才換GUI thread。</p>\\n</blockquote>\\n<p>於似乎我們可以用async defer這兩個關鍵字去處理，這蠻簡單的，直接看圖吧</p>\\n<p>\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 55.00921942224954%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3bQB/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRAAAwADAAAAAAAAAAAAAAAAABARAZHw/9oACAEBAAE/IcdDahF//9oADAMBAAIAAwAAABBDz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAIBBAMAAAAAAAAAAAAAAAABESExUYFxkdH/2gAIAQEAAT8Qa6VOUsU47C3shHjEmBKD/9k='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"js_async_n_defer\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-ca545.jpg\\\"\\n        srcset=\\\"/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-aa1b7.jpg 148w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-b937a.jpg 295w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-ca545.jpg 590w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-75639.jpg 885w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-8bd51.jpg 1180w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-868d3.jpg 1627w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  </p>\\n<p>如果使用了defer，放在header跟body後就根本沒差別了，其他的case放在body後是個保險的寫法</p>\\n<p>但有一個很重要的點</p>\\n<p><font color='red'><strong>defer不保証執行順序 defer不保証執行順序 defer不保証執行順序(由上到下)</strong></font></p>\\n<p>實際上碰到的，專案裡有一個external file是公司寫好的logger module(es5 CMD)，並不是build在webpack的entry裡。</p>\\n<p>原本是兩個檔案 A &#x26; B</p>\\n<p>因為defer不保証順序，所以我這樣寫</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>header</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">async</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">'</span>a.js<span class=\\\"token punctuation\\\">'</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>header</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">defer</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">'</span>b.js<span class=\\\"token punctuation\\\">'</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>async load完就執行，defer要等到DOMContentLoaded之前執行</p>\\n<p>覺得OK(X) 好像失敗了(O)</p>\\n<p>在正常開發人員always clean cache every refresh下完全ok</p>\\n<p>但是在browser有cache的情況下，不保証執行順序就炸了(都是0秒 loading time)</p>\\n<p>最後的解法是將兩個檔案放在一起(在最後的版本我開了一個webpack entry還是bundle了)</p>\\n<p><br/><br/></p>\\n<p>寫到這裡，先轉個話題談談css</p>\\n<p>為什麼css必須放在header呢</p>\\n<p>原因是css屬於關鍵渲染路徑(critical render path)中的一環</p>\\n<p>過慢的loading會delay domContentLoaded的時間，而因為網頁的評分中將未加載css的網頁視為沒載完(因為很醜無法閱讀)，沒辨法跟js一樣async loading</p>\\n<p>這篇<a href=\\\"https://www.cnblogs.com/libin-1/p/7127330.html\\\">文章</a>說的很好，配上上面的之前文章，直接拿結論</p>\\n<ol>\\n<li>css 不會影響dom tree parsing</li>\\n<li>css 會影響 dom tree rendering(因為css dom tree還沒建好)</li>\\n<li>css 與js互斥，原因上面講了</li>\\n</ol>\\n<p>隨便提一個 do not use @import(我用google font的時候被偵測到)，原因是又delay loading</p>\\n<p>(之後開個文章把所有有用的tunning都寫進去)</p>\\n<p>又回到js部份，這也是真的該理解的部份</p>\\n<p>既然js會block render，那反正js放header跟放body後不都一樣</p>\\n<p>這說法是對的也是錯的。</p>\\n<p>如果所謂的block render指的是complete anything and can intereact with users 那答案是yes，根本就沒差</p>\\n<p>tricky的地方其實是我們關心的是first time render view，而dom tree會在一個網頁被開啟時被重覆更新好幾次(only by js, css必定先讀完)</p>\\n<p>我在網頁文章中的理解是css dom tree的parse決定第一次paint的時間(css 不會影響dom tree parsing，會影響 dom tree rendering)結束parse才觸發js執行，而parse js的行為是會先將js前面的已經ok的dom先paint過一次</p>\\n<ol>\\n<li>css loading time > js loading time 畫面白掉無法paint</li>\\n<li>css loading time &#x3C; js loading time paint到js的那行之前</li>\\n</ol>\\n<p>所以假設</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>html</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>nav</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>nav</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"> heavy js</span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>h1</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>h1</span><span class=\\\"token punctuation\\\">></span></span>\\n    ...\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>p</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>p</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>html</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>js執行會阻止下方dom render</p>\\n<p>使用者會在first time render view只看到nav，經過了heavy js execute之後才會繼續向下。</p>\\n<p>那才是為什麼script要放body之後</p>\\n<p>這些東西我以前知道script放body之後，近期才真正弄懂它</p>\\n<br />\\n<p>不過最後思考一個問題，在spa的頁面中，請問script放在body之後有好處嗎</p>\\n<p>我的理解(請反白)</p>\\n<font color='white'>\\n沒啥鳥用，因為你的頁面是heavy js，first time render view = 空白 root element，除非有做ssr那就另當別論\\n</font>\\n<p>這算是老觀念了，我覺得有一些outdated的部份，所以才特別重新review與思考，充份了解還是聊勝於無啊。</p>\\n<p><a href=\\\"https://segmentfault.com/a/1190000004292479\\\">參考1</a></p>\\n<p><a href=\\\"https://segmentfault.com/a/1190000007766425\\\">參考2</a></p>\",\"fields\":{\"slug\":\"/posts/script-after-body/\"},\"frontmatter\":{\"title\":\"JS CSS in body( position)\",\"date\":\"2018-09-02T17:45\",\"tags\":[\"mechanic\"]}}},\"pathContext\":{\"slug\":\"/posts/script-after-body/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---posts-script-after-body-273cb8b82e281a99e166.js","module.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"前端小誌\",\"author\":\"Ernie Yang\"}},\"markdownRemark\":{\"id\":\"/Users/ernieyang09/Desktop/workspace/gatsby-blog/src/pages/posts/2018/09/0902--script-after-body.md absPath of file >>> MarkdownRemark\",\"html\":\"<snippet>\\n  天啊，原本預計一個月一篇文章，由於本人跑去當了full stack，變得太忙了，周末只想好好休息耍廢。最近新專案終於要上了，處理的也差不多了。只剩一些小bug與performance需要調整我會想辨法，我會努力把文章補回。未來再來看看要不要加一些後端文章(那就不是前端小誌了XD)\\n</snippet>\\n<p>這篇先來個簡單的東西吧，就是script tag, link到底要放在html的哪裡呢</p>\\n<p>直接先講結論</p>\\n<blockquote>\\n<p>放在body之後絕對沒毛病</p>\\n</blockquote>\\n<p>從最簡單講起，大多數人一定知道loading js會block browser的render機制</p>\\n<p>很多<a href=\\\"/posts/browser-mechanic/\\\">之前</a>的概念要知道</p>\\n<blockquote>\\n<p>GUI與JS \\bthread是戶斥的，因為當repaint的時候會觸發GUI \\bthread，但JS執行後很有可能會造成多次repaint，於是乎JS在執行的時候會先block GUI thread，待JS結束後才換GUI thread。</p>\\n</blockquote>\\n<p>於似乎我們可以用async defer這兩個關鍵字去處理，這蠻簡單的，直接看圖吧</p>\\n<p>\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 55.00921942224954%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3bQB/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRAAAwADAAAAAAAAAAAAAAAAABARAZHw/9oACAEBAAE/IcdDahF//9oADAMBAAIAAwAAABBDz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAIBBAMAAAAAAAAAAAAAAAABESExUYFxkdH/2gAIAQEAAT8Qa6VOUsU47C3shHjEmBKD/9k='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"js_async_n_defer\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-ca545.jpg\\\"\\n        srcset=\\\"/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-aa1b7.jpg 148w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-b937a.jpg 295w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-ca545.jpg 590w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-75639.jpg 885w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-8bd51.jpg 1180w,\\n/static/js_async_n_defer-8fb190e9baa4e48eb996dd90c239547b-868d3.jpg 1627w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  </p>\\n<p>如果使用了defer，放在header跟body後就根本沒差別了，其他的case放在body後是個保險的寫法</p>\\n<p>但有一個很重要的點</p>\\n<p><font color='red'><strong>defer不保証執行順序 defer不保証執行順序 defer不保証執行順序(由上到下)</strong></font></p>\\n<p>實際上碰到的，專案裡有一個external file是公司寫好的logger module(es5 CMD)，並不是build在webpack的entry裡。</p>\\n<p>原本是兩個檔案 A &#x26; B</p>\\n<p>因為defer不保証順序，所以我這樣寫</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>header</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">async</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">'</span>a.js<span class=\\\"token punctuation\\\">'</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>header</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">defer</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">'</span>b.js<span class=\\\"token punctuation\\\">'</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>async load完就執行，defer要等到DOMContentLoaded之前執行</p>\\n<p>覺得OK(X) 好像失敗了(O)</p>\\n<p>在正常開發人員always clean cache every refresh下完全ok</p>\\n<p>但是在browser有cache的情況下，不保証執行順序就炸了(都是0秒 loading time)</p>\\n<p>最後的解法是將兩個檔案放在一起(在最後的版本我開了一個webpack entry還是bundle了)</p>\\n<p><br/><br/></p>\\n<p>寫到這裡，先轉個話題談談css</p>\\n<p>為什麼css必須放在header呢</p>\\n<p>原因是css屬於關鍵渲染路徑(critical render path)中的一環</p>\\n<p>過慢的loading會delay domContentLoaded的時間，而因為網頁的評分中將未加載css的網頁視為沒載完(因為很醜無法閱讀)，沒辨法跟js一樣async loading</p>\\n<p>這篇<a href=\\\"https://www.cnblogs.com/libin-1/p/7127330.html\\\">文章</a>說的很好，配上上面的之前文章，直接拿結論</p>\\n<ol>\\n<li>css 不會影響dom tree parsing</li>\\n<li>css 會影響 dom tree rendering(因為css dom tree還沒建好)</li>\\n<li>css 與js互斥，原因上面講了</li>\\n</ol>\\n<p>隨便提一個 do not use @import(我用google font的時候被偵測到)，原因是又delay loading</p>\\n<p>(之後開個文章把所有有用的tunning都寫進去)</p>\\n<p>又回到js部份，這也是真的該理解的部份</p>\\n<p>既然js會block render，那反正js放header跟放body後不都一樣</p>\\n<p>這說法是對的也是錯的。</p>\\n<p>如果所謂的block render指的是complete anything and can intereact with users 那答案是yes，根本就沒差</p>\\n<p>tricky的地方其實是我們關心的是first time render view，而dom tree會在一個網頁被開啟時被重覆更新好幾次(only by js, css必定先讀完)</p>\\n<p>我在網頁文章中的理解是css dom tree的parse決定第一次paint的時間(css 不會影響dom tree parsing，會影響 dom tree rendering)結束parse才觸發js執行，而parse js的行為是會先將js前面的已經ok的dom先paint過一次</p>\\n<ol>\\n<li>css loading time > js loading time 畫面白掉無法paint</li>\\n<li>css loading time &#x3C; js loading time paint到js的那行之前</li>\\n</ol>\\n<p>所以假設</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>html</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>nav</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>nav</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"> heavy js</span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>h1</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>h1</span><span class=\\\"token punctuation\\\">></span></span>\\n    ...\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>p</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>p</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>html</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>js執行會阻止下方dom render</p>\\n<p>使用者會在first time render view只看到nav，經過了heavy js execute之後才會繼續向下。</p>\\n<p>那才是為什麼script要放body之後</p>\\n<p>這些東西我以前知道script放body之後，近期才真正弄懂它</p>\\n<br />\\n<p>不過最後思考一個問題，在spa的頁面中，請問script放在body之後有好處嗎</p>\\n<p>我的理解(請反白)</p>\\n<font color='white'>\\n沒啥鳥用，因為你的頁面是heavy js，first time render view = 空白 root element，除非有做ssr那就另當別論\\n</font>\\n<p>這算是老觀念了，我覺得有一些outdated的部份，所以才特別重新review與思考，充份了解還是聊勝於無啊。</p>\\n<p><a href=\\\"https://segmentfault.com/a/1190000004292479\\\">參考1</a></p>\\n<p><a href=\\\"https://segmentfault.com/a/1190000007766425\\\">參考2</a></p>\",\"fields\":{\"slug\":\"/posts/script-after-body/\"},\"frontmatter\":{\"title\":\"JS CSS in body( position)\",\"date\":\"2018-09-02T17:45\",\"tags\":[\"mechanic\"]}}},\"pathContext\":{\"slug\":\"/posts/script-after-body/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/posts-script-after-body.json\n// module id = 479\n// module chunks = 27383442544989"],"sourceRoot":""}