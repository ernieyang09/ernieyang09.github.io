webpackJsonp([0xf070997f7014],{453:function(a,t){a.exports={data:{site:{siteMetadata:{title:"前端小誌",author:"Ernie Yang"}},markdownRemark:{id:"/Users/ernieyang09/Desktop/workspace/gatsby-blog/src/pages/posts/2017/09/0928--aws-s3-cdn-53.md absPath of file >>> MarkdownRemark",html:'<p><snippet>在公司做的頁面要上啦，說明要用AWS，跳坑研究一下(嗚嗚 需要devOps)，總共用了S3、CloudFront、Route53</snippet></p>\n<h3>S3 (Simple Storage Service)</h3>\n<p>雲端儲存，create一個bucket放置檔案，操作蠻簡單的。</p>\n<p>因為是要用來架站用，所有東西都要能被外界使用，所以要設立權限。這邊的權限是bucket裡面的object，而非bucket本身。\n\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 72.6161369193154%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACJ0lEQVQ4y6WTW2sTQRTH55sqvkhR8SFWJIKKUCJtFCltqb74UPwCPlibIuhDbdAULy+SS3Mzm71nd2c3e9/9e3ZsJJa0VRz4cYY5Z/5z5swZ5gQJrGmELM8xP+IkgR+GgiCKaCVHnqfCJmkCz/cxDQJh52G7Bw28PvyM2sFHvK0fofbpK97QmqTq0CYWDGJM8/3DBvbJt/uhgW/NjjhkJjoPK61tYXn9BUqVddxa3cT97R2UqxswlDEQcDi2hf5whOXqNm5v7WCpsomXr/YQxTEc1wOfTv+AuWEK7sfwogyceHako1rXsVrX8PyLBTcGnIBiRFyCWWXyPF8IM6YpdML0Uxh+hrvvVdyoSbi+N0L5nUy+BCqpyjyCQjZO8xNBLBxMM0xougFVMyCrGrhlIYtC2pEKYrpanmX428Ga3QF008LE5rAcFzb34HpUbD8QtqhTEP7qgpSEswtgpUcb9IoapPEYY0VGq93GcbdLB9gIKbvgpHVOv+ZZsKv31jDWdPQHQxz3epBkGcORROKKED3dZxfBlh48hmpOqNgpeoMBOpTd92YLzXYHsqLCpVaYBc8yPVfw2sMnQjBKYnT7fTRbbZGdopKY54kfU/RcYS3boZq655aA3Vx5iqEk04M4MOmKpmWLTcVpnAQ5zYUlJtQBRVzhtzlfCLtSruCHrMCjqxWBIviMDTP/77gFa+zSnRUo1IvFiy76m/8Ku0yCMjV2ePLZ/5efJ31j33wQGyAAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="s3-1"\n        title=""\n        src="/static/s3-1-970dab34abfe188cfe51567b5c6f38be-a408b.png"\n        srcset="/static/s3-1-970dab34abfe188cfe51567b5c6f38be-4eabf.png 148w,\n/static/s3-1-970dab34abfe188cfe51567b5c6f38be-5a375.png 295w,\n/static/s3-1-970dab34abfe188cfe51567b5c6f38be-a408b.png 590w,\n/static/s3-1-970dab34abfe188cfe51567b5c6f38be-24515.png 818w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  </p>\n<p>可以使用AWS的policy generator即可。\n\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 88.58195211786372%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACvklEQVQ4y4VU2W7TQBTNlyPxAYgHnqh4QG02LzPeIiEeEGrrCBVUCbUSraDQIIITO3HixClqs/hw73hpQkFEOrkznpkz525T0w0D+wcHaDRbqNcb0HQDQlqQUiorhFRjNRc0lzak5RSwYVmWgm3n45olTAi9DVNjaDAImmbANC0YpoRuSBoLBTUWNh12CU4Bu4JDqAlS2CZ10mjDMnWCBluK/FZ1u6TNVqHErpQppQVy1bmtua4Hh2AKVmOSKlZjQtd1ZR3Hgeu6hNJ6f9hd1BxpwjZJnd6E1OrKOrZURAq0yXEYnrLlwfwiD16nA8/zKtTYLUFKLHJTUjx1iqVWqDMNvYifLCDUXl4zaI+g/WU4mEcpzJnzWzp0m//uA/z35zg5PcfZxTdcXP2ocFnYq+/DAgN86Q2U/Xwd4M3bQ45h7gITcgKur3uYpwtMpjNMkzlG4xjj8QSjUYyIkC5+4V+/Y98vFXoFoYUgCJCmKSaTCaaEdD5HttkgyzLCBvSHDc23wd/X6xUOD0khB5czygWuUQ0OBgPcLG4QhhFmsxnmRLhcrpSCnHRXVVZ8YOKjo6Pc5VIhk0dRRIoy9Pt9cnVMZMuCKNsifTiuCLdd5loLwxCr1YpiNlKur9frncN/wz1hkZS8zlzVCcPB8EGw7w9v/kN4jJqkwm619qm2WgpB8JMWM9ze3ip3GXd3d8quKSer1bqab68zoe9zUmwqVtGi7tAVgqCPxWKBJJlSUhKVFE5OkiTo904xiYf0La2+sZ1Op0S6xMlJlzqFqt0yNGq5FkS7icuLTxjHM4SjJAdlO4pCVU4f/T30vp4hjGIVa04ax5oRxzG63W5eNuV7xm3ET1O7sYfGyyeEp9SKTXo48vZyO6/VOr+NvL/s6RJbrVfCpfZ7Ba3+DPvPH6H+4jH1LBFKr3pxeM/umV38BlH6wVQRQfHTAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="s3-2"\n        title=""\n        src="/static/s3-2-822f2cc9c4f0bb8735dd56ff463f9b90-a408b.png"\n        srcset="/static/s3-2-822f2cc9c4f0bb8735dd56ff463f9b90-4eabf.png 148w,\n/static/s3-2-822f2cc9c4f0bb8735dd56ff463f9b90-5a375.png 295w,\n/static/s3-2-822f2cc9c4f0bb8735dd56ff463f9b90-a408b.png 590w,\n/static/s3-2-822f2cc9c4f0bb8735dd56ff463f9b90-9a0cc.png 885w,\n/static/s3-2-822f2cc9c4f0bb8735dd56ff463f9b90-c03c5.png 1086w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  </p>\n<p>但要特別注意一點，在產生的Resource後面要加上/*，不然會發生<a href="https://stackoverflow.com/questions/44228422/s3-bucket-action-doesnt-apply-to-any-resources">Action does not apply to any resource(s) in statement\b</a>。</p>\n<p>如果只是要架一個簡單的網站，到這邊配上Static website hosting就很夠了，使用c\bdn的話這邊不需要hosting。</p>\n<h3>CloudFront</h3>\n<p>AWS提供的cdn服務</p>\n<p>選擇web服務，Origin Domain Name選擇剛剛建立的S3 bucket，小設定不提，因為我要用cdn架站，再用Route53指過來，\nDefault Root Object要寫entry，每個人應該都是index.html。Compress Objects Automatically可以加速，記得打開。另外一個重要的點，\n跑SPA網站，網站的route是由前端控制，\bhosting可以由Error Pages設定。\n\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 45.16880093131548%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABC0lEQVQoz4WQ6W6DMBCEef/3C384i4AoBGyKEUc4psy2jpLiqpZGXoP38854QRAgyzLEcYw8z0VpmiIIA/Bf27bg2rYN+77/Ky8MQyRJgiiKRDzHx+77Pq7X6wnE87auP/V6kjdNEx7zA/M8o2kaUdd1z3oYBozjKGK9rotA+77/hv+SRzvr8SKBWmuBmANY3+8yYV3XMMaIaH9ZFolAKQXXEiAheV5Ifv7lguQjg/7s8deiXfY4M+QF2uHrxvTHrtGaAcVNHVktJ0u2kbFYOPWc0B6YCe3RCi03R611KxBGYncL4ACvk71Z5gfCiqKQ3JTSKMsSVVXJQ64Med+CnMB9f7fGRpdeIS7gF+FQutjxxuL1AAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="cloudfront-1"\n        title=""\n        src="/static/cloudfront-1-c9d09870ac47be483a77c3a01239bd97-a408b.png"\n        srcset="/static/cloudfront-1-c9d09870ac47be483a77c3a01239bd97-4eabf.png 148w,\n/static/cloudfront-1-c9d09870ac47be483a77c3a01239bd97-5a375.png 295w,\n/static/cloudfront-1-c9d09870ac47be483a77c3a01239bd97-a408b.png 590w,\n/static/cloudfront-1-c9d09870ac47be483a77c3a01239bd97-9a0cc.png 885w,\n/static/cloudfront-1-c9d09870ac47be483a77c3a01239bd97-aa987.png 1180w,\n/static/cloudfront-1-c9d09870ac47be483a77c3a01239bd97-ecaf3.png 1718w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  \n如此一來，如果有人直接打上路由，會被導到index並且正常的轉到該顯示的頁面。</p>\n<h3>Route53</h3>\n<p>AWS提供的dns控管服務</p>\n<p>如果CloudFront要串到這裡，Alternate Domain Names (CNAMEs)要先打上Route53即將要給的domain，這邊好像沒什麼特別要注意的。CloudFront那邊可以設定ipv6，\bipv4就選A然後選alias貼上CloudFront的網址(\bxxxxx.cloudfront.net)，有ipv6就AAAA也設定一下。不確定是不是CloudFront要Delpoyed才能生效(\bCloudFront每次進入in progess都要1x-2x分鐘)</p>\n<p>PS.</p>\n<p>還有遇到ssl問題啦(如果CloudFront走https又改domain)，結果custom ssl一直反白，Certificate只能用\b<a href="https://stackoverflow.com/questions/28609262/unable-to-select-custom-ssl-certificate-stored-in-aws-iam">美東</a>的啦</p>\n<p>呼，總算弄完了!!</p>',fields:{slug:"/posts/aws-s3-cdn-53/"},frontmatter:{title:"AWS簡略記",date:"2017-09-28T21:49",tags:["AWS"]}}},pathContext:{slug:"/posts/aws-s3-cdn-53/"}}}});
//# sourceMappingURL=path---posts-aws-s-3-cdn-53-2934e12f0e18de21ae03.js.map